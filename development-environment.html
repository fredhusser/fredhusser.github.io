<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Part 1 - Set-up of a development environment for Python Data Analysis with Vagrant, Docker and Anaconda - Data Science for collective intelligence</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://fredhusser.github.io/development-environment.html">

        <meta name="author" content="Frederic Husser" />
        <meta name="keywords" content="Vagrant,Docker,Python" />
        <meta name="description" content="We will fire up a virtual development environment using state-of-art tools for making data analysis in Python. We will use both Vagrant and Docker for firing up a Linux virtual machine with all tools ready for Python data analysis. Preparing the Python environment is sometimes hard for scientists without a strong background in software development, this is wy having a reproducible and turnkey workflow is so important. Additionally when it comes to collaboration, the installation of the Python interpreters as well as all the needed packages can become a real pain. With virtual environment, you are making sure that everybody is working under the same settings." />

        <meta property="og:site_name" content="Data Science for collective intelligence" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Part 1 - Set-up of a development environment for Python Data Analysis with Vagrant, Docker and Anaconda"/>
        <meta property="og:url" content="http://fredhusser.github.io/development-environment.html"/>
        <meta property="og:description" content="We will fire up a virtual development environment using state-of-art tools for making data analysis in Python. We will use both Vagrant and Docker for firing up a Linux virtual machine with all tools ready for Python data analysis. Preparing the Python environment is sometimes hard for scientists without a strong background in software development, this is wy having a reproducible and turnkey workflow is so important. Additionally when it comes to collaboration, the installation of the Python interpreters as well as all the needed packages can become a real pain. With virtual environment, you are making sure that everybody is working under the same settings."/>
        <meta property="article:published_time" content="2015-12-10" />
            <meta property="article:section" content="Python" />
            <meta property="article:tag" content="Vagrant" />
            <meta property="article:tag" content="Docker" />
            <meta property="article:tag" content="Python" />
            <meta property="article:author" content="Frederic Husser" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://fredhusser.github.io/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://fredhusser.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://fredhusser.github.io/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://fredhusser.github.io/theme/css/style.css" type="text/css"/>
        <link href="http://fredhusser.github.io/static/css/bootstrap.spacelab.min.css" rel="stylesheet">

        <link href="http://fredhusser.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Data Science for collective intelligence ATOM Feed"/>



        <link href="http://fredhusser.github.io/feeds/python.atom.xml" type="application/atom+xml" rel="alternate"
              title="Data Science for collective intelligence Python ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://fredhusser.github.io/" class="navbar-brand">
Data Science for collective intelligence            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="http://fredhusser.github.io/category/python.html">Python</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://fredhusser.github.io/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://fredhusser.github.io/development-environment.html"
                       rel="bookmark"
                       title="Permalink to Part 1 - Set-up of a development environment for Python Data Analysis with Vagrant, Docker and Anaconda">
                        Part 1 - Set-up of a development environment for Python Data Analysis with Vagrant, Docker and Anaconda
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-12-10T12:00:00+01:00"> jeu. 10 d√©cembre 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://fredhusser.github.io/tag/vagrant.html">Vagrant</a>
        /
	<a href="http://fredhusser.github.io/tag/docker.html">Docker</a>
        /
	<a href="http://fredhusser.github.io/tag/python.html">Python</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>In this tutorial, we build an environment with Vagrant, Docker and Anaconda for doing firstly data analysis in Python. It should be totally agnostic on the choice of your operating system, be it Linux, Mac or Windows. Vagrant is used for configuring the linux Ubuntu virtual machine. The vagrant file located at the root of the project directory contains all the settings for that VM so that it can boot with all dependencies provisioned </p>
<p>Before starting make sure that you do have this three softwares installed on your machine:</p>
<ul>
<li>VirtualBox</li>
<li>Vagrant</li>
<li>Git</li>
</ul>
<h2 id="configuring-a-linux-ubuntu-machine">Configuring a Linux Ubuntu machine</h2>
<p>Create a directory in which you will start the project. Of course the repository with all the code is available on GitHub, so that you can get started faster by cloning it.</p>
<p>In order to stress on the most important parts of our setup, we will go through the configuration ste-by-step.</p>
<div class="highlight"><pre><span class="code-line"><span class="nv">$ </span>mkdir collective-intelligence</span>
<span class="code-line"><span class="nv">$ </span><span class="nb">cd </span>collective-intelligence</span>
</pre></div>


<p>We will create a Vagrant configuration file Vagrantfile that will contain all information necessary to build and run the virtual machine. We setup the name of the VM, the network settings and port forwarding. We also add a synchronized folder so that all changes in the file system of the host machine are taken into account in the file system of the guest. </p>
<div class="highlight"><pre><span class="code-line">VAGRANTFILE_API_VERSION = &quot;2&quot;</span>
<span class="code-line">Vagrant.configure(2) do |config|</span>
<span class="code-line">    config.vm.box = &quot;ubuntu/trusty64&quot;</span>
<span class="code-line">    config.vm.hostname = &quot;vagrant-docker-anaconda&quot;</span>
<span class="code-line">    config.vm.network &quot;private_network&quot;, ip: &quot;192.168.50.100&quot;</span>
<span class="code-line">    config.vm.network &quot;forwarded_port&quot;, guest: 80, host: 8080</span>
<span class="code-line">    config.vm.provider :virtualbox do |vb|</span>
<span class="code-line">        vb.customize [&quot;modifyvm&quot;, :id, &quot;--memory&quot;, &quot;1024&quot;, &quot;--cpus&quot;, &quot;2&quot;]</span>
<span class="code-line">    end</span>
<span class="code-line"></span>
<span class="code-line">    config.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, :type =&gt; &quot;nfs&quot;</span>
<span class="code-line">    end</span>
</pre></div>


<p>Once the Vagrantfile is defined you are able to build and run the VM simply by typing:</p>
<div class="highlight"><pre><span class="code-line"><span class="nv">$ </span>vagrant up</span>
</pre></div>


<h2 id="provisioning-with-the-necessary-software">Provisioning with the necessary software</h2>
<p>For starting developping applications for data analysis we need a Python distribution. For data analysis in Python, Anaconda offered by Continuum Analytics is very convenient, and contains all the necessary packages. First connect through ssh to your running VM in one command line.</p>
<div class="highlight"><pre><span class="code-line"><span class="nv">$ </span>vagrant ssh</span>
</pre></div>


<p>Then we will install anaconda. From the bash terminal connected to your VM, you can install Anaconda</p>
<div class="highlight"><pre><span class="code-line"><span class="nv">$ </span>sudo apt-get update</span>
<span class="code-line"></span>
<span class="code-line"><span class="c"># Download from the Anaconda remote directory</span></span>
<span class="code-line"><span class="nv">$ </span>sudo wget http://09c8d0b2229f813c1b93-c95ac804525aac4b6dba79b00b39d1d3.r79.cf1.rackcdn.com/Anaconda-2.1.0-Linux-x86_64.sh</span>
<span class="code-line"></span>
<span class="code-line"><span class="c"># Install the Anaconda distribution in batch mode</span></span>
<span class="code-line"><span class="nv">$ </span>sudo bash Anaconda-2.1.0-Linux-x86_64.sh -b</span>
<span class="code-line"></span>
<span class="code-line"><span class="c"># Append the path of the Anaconda Python interpreter into your path</span></span>
<span class="code-line"><span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/home/vagrant/anaconda/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c"># Update the package manager and install pymongo as we will use it</span></span>
<span class="code-line"><span class="nv">$ </span>sudo conda update -y conda</span>
<span class="code-line"><span class="nv">$ </span>sudo conda install -y pymongo</span>
</pre></div>


<p>Now you are all set and ready to work with Python. You can check your installation by starting the Python interpreter.</p>
<div class="highlight"><pre><span class="code-line">vagrant@vagrant-docker-anaconda:~<span class="nv">$ </span>python</span>
<span class="code-line">Python 2.7.10 <span class="p">|</span>Anaconda 2.1.0 <span class="o">(</span>64-bit<span class="o">)</span><span class="p">|</span> <span class="o">(</span>default, Oct <span class="m">19</span> 2015, 18:04:42<span class="o">)</span></span>
<span class="code-line"><span class="o">[</span>GCC 4.4.7 <span class="m">20120313</span> <span class="o">(</span>Red Hat 4.4.7-1<span class="o">)]</span> on linux2</span>
<span class="code-line">Type <span class="s2">&quot;help&quot;</span>, <span class="s2">&quot;copyright&quot;</span>, <span class="s2">&quot;credits&quot;</span> or <span class="s2">&quot;license&quot;</span> <span class="k">for</span> more information.</span>
<span class="code-line">Anaconda is brought to you by Continuum Analytics.</span>
<span class="code-line">Please check out: http://continuum.io/thanks and https://anaconda.org</span>
<span class="code-line">&gt;&gt;&gt;</span>
</pre></div>


<h2 id="using-docker-for-our-database-and-web-application">Using Docker for our database and web application</h2>
<p>Now we are almost ready to develop our machine learning application ! We also want to have a MongoDB and Postgres SQL instances running, as well as a web application (in Python of course!). We will use Docker and Docker-Compose for that and build a multi-container application. Basically we want to have:</p>
<ul>
<li>A <strong>MongoDB</strong> server that will be accessible on the localhost of our VM, in which we will store our collected data and the outputs of the machine learning tasks;</li>
<li>A <strong>PostgresSQL</strong> server that will support our web application data;</li>
<li>A <strong>Flask</strong> back-end for our application, which we will use for communicating our results to the outside world;</li>
<li>An <strong>nginx</strong> service to forward requests either to the Flask app or the static files;</li>
<li>Some <strong>data-only containers</strong> that will back-up the data from the database services.</li>
</ul>
<p>Check out this blog post from <a href="https://realpython.com/blog/python/dockerizing-flask-with-compose-and-machine-from-localhost-to-the-cloud/">Real Python</a> which explains the process of building a muti-container application with flask, and from which we got inspired to build the docker-compose.yml file:</p>
<div class="highlight"><pre><span class="code-line"><span class="n">mongo</span><span class="o">:</span></span>
<span class="code-line">  <span class="n">restart</span><span class="o">:</span> <span class="n">always</span></span>
<span class="code-line">  <span class="n">image</span><span class="o">:</span> <span class="n">mongo</span><span class="o">:</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span></span>
<span class="code-line">  <span class="n">volumes_from</span><span class="o">:</span></span>
<span class="code-line">    <span class="o">-</span> <span class="n">data_mongo</span></span>
<span class="code-line">  <span class="n">ports</span><span class="o">:</span></span>
<span class="code-line">    <span class="o">-</span> <span class="s2">&quot;27017:27017&quot;</span></span>
<span class="code-line">  <span class="n">expose</span><span class="o">:</span></span>
<span class="code-line">    <span class="o">-</span> <span class="s2">&quot;27017&quot;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">data_mongo</span><span class="o">:</span></span>
<span class="code-line">  <span class="n">image</span><span class="o">:</span> <span class="n">mongo</span><span class="o">:</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span></span>
<span class="code-line">  <span class="n">volumes</span><span class="o">:</span></span>
<span class="code-line">    <span class="o">-</span> <span class="s2">&quot;/vagrant/data/mongo:/var/lib/mongo:rw&quot;</span></span>
<span class="code-line">  <span class="n">entrypoint</span><span class="o">:</span> <span class="s2">&quot;/bin/true&quot;</span></span>
</pre></div>


<p>In order to make Vagrant able to run the containers as soon it starts up, you have to provision Docker and Docker-Compose from the Vagrantfile, in which you must add the following:</p>
<div class="highlight"><pre><span class="code-line">config.vm.provision :docker</span>
<span class="code-line">config.vm.provision :docker_compose, yml: &quot;/vagrant/docker-compose.yml&quot;, rebuild: true, run: &quot;always&quot;</span>
</pre></div>


<p>By reloading the VM this will be taken into account and the docker client will try to build our MongoDB container. If you look directly into the repository you will notice that the other containers (nginx, Flask, PostgresSQL) are also defined. However it is out of the scope of this first set-up step to explain in details how to build them.</p>
<div class="highlight"><pre><span class="code-line"><span class="nv">$ </span>vagrant reload</span>
</pre></div>


<p>If the VM reloads successfully, it can take few minutes for Docker to set-up, you can check that the MongoDB container is effectively there. First reconnect by ssh to your VM and test your docker:</p>
<div class="highlight"><pre><span class="code-line">vagrant@vagrant-docker-anaconda:~<span class="nv">$ </span>docker ps</span>
<span class="code-line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                      NAMES</span>
<span class="code-line">0c7cc8c4d3cd        mongo:3.0.2         <span class="s2">&quot;/entrypoint.sh mongo&quot;</span>   <span class="m">10</span> days ago         Up <span class="m">5</span> hours          0.0.0.0:27017-&gt;27017/tcp   vagrant_mongo_1</span>
</pre></div>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://fredhusser.github.io/web-crawling.html">Part 2 - Crawling a news website in Python with Scrapy and MongoDB</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/fredhusser"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
              </ul>
            </li>



            <li class="list-group-item"><a href="http://fredhusser.github.io/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group " id="tags">
                    <li class="list-group-item tag-1">
                        <a href="http://fredhusser.github.io/tag/python.html">
                            Python
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/agile-data-science.html">
                            Agile Data Science
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/machine-learning.html">
                            Machine Learning
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/mongodb.html">
                            MongoDB
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/vagrant.html">
                            Vagrant
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/scrapy.html">
                            Scrapy
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/dev-environment.html">
                            dev environment
                        </a>
                    </li>
                    <li class="list-group-item tag-5">
                        <a href="http://fredhusser.github.io/tag/docker.html">
                            Docker
                        </a>
                    </li>
                </ul>
            </li>


    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="/" target="_blank">
                Home
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Frederic Husser
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://fredhusser.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://fredhusser.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://fredhusser.github.io/theme/js/respond.min.js"></script>


</body>
</html>